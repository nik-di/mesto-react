(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],[,,,,,function(e,t,a){e.exports=a.p+"static/media/icon-close.a3e3d9bd.svg"},,,,,function(e,t,a){e.exports=a.p+"static/media/logo.9d0e3a93.svg"},,,,,function(e,t,a){e.exports=a(30)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(9),c=a.n(r),i=(a(20),a(14)),u=a(3),l=a(1),s=(a(21),a(22),a(10)),p=a.n(s);var m=function(){return o.a.createElement("header",{className:"header root__section"},o.a.createElement("img",{src:p.a,alt:"Mesto \u043b\u043e\u0433\u043e\u0442\u0438\u043f",className:"logo"}))};a(23);var d=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__text"},"Mesto Russia by NDI \xa92020"))},f=(a(24),a(25),a(5)),h=a.n(f);var _=function(e){var t=e.handleClosePopup,a=e.selectedImage;return o.a.createElement("div",{onClick:function(e){var a=e.target;e.keyCode,!a.classList.contains("popup-image__image")&&t()},className:"popup popup_type_image popup_is-opened"},o.a.createElement("div",{className:"popup-image__content"},o.a.createElement("img",{src:h.a,alt:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e",className:"popup-close"}),o.a.createElement("img",{src:a,className:"popup-image__image",alt:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438"})))},b=Object(n.createContext)(),v=(a(26),Object(n.memo)((function(e){var t=e.cardData,a=t.name,r=t.likes,c=t.link,i=t._id,u=t.owner,l=e.imageCardClickHandler,s=e.deleteHandler,p=e.likeHandler,m=Object(n.useContext)(b),d=m._id===u._id,f=r.some((function(e){return e._id===m._id}));return o.a.createElement("div",{id:i,className:"place-card"},o.a.createElement("button",{onClick:function(){d&&s(i)},disabled:!d,className:"place-card__delete-icon"}),o.a.createElement("div",{className:"place-card__image",style:{backgroundImage:"url(".concat(c,")")},onClick:function(e){var t=e.target.style.backgroundImage.slice(5,-2);l(t)}}),o.a.createElement("div",{className:"place-card__description"},o.a.createElement("h3",{className:"place-card__name"},a),o.a.createElement("div",null,o.a.createElement("button",{onClick:function(){p(i,f)},className:"place-card__like-icon"+"".concat(f?" place-card__like-icon_liked":"")}),o.a.createElement("div",{className:"place-card__like-counter"},r.length))))})));a(27);var g=function(e){var t=e.handleClosePopup,a=e.title,n=e.popupName,r=e.children,c=function(e){var a=e.target,n=e.currentTarget,o=e.keyCode;(a.classList.contains("popup-close")||a===n)&&t();27===o&&t()};return o.a.createElement("div",{onClick:c,onKeyUp:c,className:"popup popup_type_".concat(n," popup_is-opened")},o.a.createElement("div",{className:"popup__content"},o.a.createElement("img",{src:h.a,alt:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e",className:"popup-close"}),o.a.createElement("h3",{className:"popup__title"},a),r&&r))},E=Object(n.memo)((function(e){var t=e.isEditProfileOpen,a=e.onEditProfilePopupToggle,r=e.onSubmitProfile,c=Object(n.useContext)(b),i=c.name,u=c.about,s=Object(n.useState)(""),p=Object(l.a)(s,2),m=p[0],d=p[1],f=Object(n.useState)(""),h=Object(l.a)(f,2),_=h[0],v=h[1];Object(n.useEffect)((function(){d(i),v(u)}),[i,u]);return t&&o.a.createElement(g,{handleClosePopup:a,popupName:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",children:o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),r({name:m,about:_})},className:"popup__form",name:"edit"},o.a.createElement("div",null,o.a.createElement("input",{required:!0,type:"text",name:"name-profile",className:"popup__input popup-edit__input_type_name",placeholder:"\u0418\u043c\u044f",maxLength:"30",value:m,onChange:function(e){var t=e.target;d(t.value)}}),o.a.createElement("span",{className:"error-name-profile error-message"+"".concat(m.length<2?" error-message_active":"")},"\u0414\u043b\u0438\u043d\u0430 \u0438\u043c\u0435\u043d\u0438 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u0435\u0435 2-\u0445 \u0431\u0443\u043a\u0432")),o.a.createElement("div",null,o.a.createElement("input",{required:!0,type:"text",name:"about-profile",className:"popup__input popup-edit__input_type_about",placeholder:"\u041e \u0441\u0435\u0431\u0435",maxLength:"30",value:_,onChange:function(e){var t=e.target;v(t.value)}}),o.a.createElement("span",{className:"error-about-profile error-message"+"".concat(_.length<1?" error-message_active":"")},"\u0414\u043b\u0438\u043d\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u0435\u0435 1-\u0433\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u0430")),o.a.createElement("button",{type:"submit",className:"button popup__button"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))})})),P=a(11),O=a.n(P),k={require_protocol:!0},N=function(e){return O()(e,k)},C=Object(n.memo)((function(e){var t=e.isAddPlacePopupOpen,a=e.onAddPlacePopupToggle,r=e.onSubmitPlace,c=Object(n.useState)(""),i=Object(l.a)(c,2),u=i[0],s=i[1],p=Object(n.useState)(""),m=Object(l.a)(p,2),d=m[0],f=m[1],h=u.length>2&&N(d);return t&&o.a.createElement(g,{handleClosePopup:a,popupName:"add-card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",children:o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),h&&r(u,d)},noValidate:!0,className:"popup__form",name:"new"},o.a.createElement("div",null,o.a.createElement("input",{required:!0,type:"text",name:"name",className:"popup__input popup__input_type_name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",value:u,onChange:function(e){var t=e.target;s(t.value)}}),o.a.createElement("span",{className:"error-name error-message"})),o.a.createElement("div",null,o.a.createElement("input",{required:!0,type:"url",name:"link",className:"popup__input popup__input_type_link-url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",value:d,onChange:function(e){var t=e.target;f(t.value)}}),o.a.createElement("span",{className:"error-link error-message"})),o.a.createElement("button",{type:"submit",className:"button popup__button",disabled:!h},"+"))})})),j=Object(n.memo)((function(e){var t=e.isEditAvatarPopupOpen,a=e.onEditAvatarPopupToggle,r=e.onSubmitAvatar,c=Object(n.useRef)(),i=Object(n.useRef)();return t&&o.a.createElement(g,{handleClosePopup:a,popupName:"edit-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",children:o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),r({avatar:c.current.value})},className:"popup__form",name:"avatar"},o.a.createElement("div",null,o.a.createElement("input",{ref:c,required:!0,type:"url",name:"link",className:"popup__input popup__input_type_link-url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",onChange:function(){c.current.validity.valid?i.current.removeAttribute("disabled"):i.current.setAttribute("disabled","")}}),o.a.createElement("span",{className:"error-name error-message"})),o.a.createElement("button",{ref:i,type:"submit",className:"button popup__button",disabled:!0},"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440"))})})),y=Object(n.memo)((function(e){var t=e.isAddPlacePopupOpen,a=e.isEditAvatarPopupOpen,r=e.isEditProfileOpen,c=e.onAddPlacePopupToggle,i=e.onEditAvatarPopupToggle,u=e.onEditProfilePopupToggle,l=e.onCardClick,s=e.selectedImage,p=e.submitProfile,m=e.onSubmitAvatar,d=e.cards,f=e.onCardDelete,h=e.onCardLike,g=e.onSubmitPlace,P=Object(n.useContext)(b),O=P.name,k=P.about,N=P.avatar,y=function(e){f(e)},S=function(e,t){h(e,t)};return o.a.createElement("main",{className:"main"},o.a.createElement("section",{className:"profile root__section"},o.a.createElement("div",{className:"user-info"},o.a.createElement("div",{style:{backgroundImage:"url(".concat(N,")")},onClick:i,className:"user-info__photo"}),o.a.createElement("div",{className:"user-info__data"},o.a.createElement("h1",{className:"user-info__name"},O),o.a.createElement("p",{className:"user-info__job"},k),o.a.createElement("button",{onClick:u,className:"button user-info__edit-button"},"Edit")),o.a.createElement("button",{onClick:c,className:"button user-info__button"},"+"))),o.a.createElement("section",{className:"places-list root__section"},d.length&&d.map((function(e){return o.a.createElement(v,{key:e._id,cardData:e,imageCardClickHandler:l,likeHandler:S,deleteHandler:y})}))),o.a.createElement("section",{className:"popup-container"},s&&o.a.createElement(_,{handleClosePopup:l,selectedImage:s}),o.a.createElement(E,{isEditProfileOpen:r,onEditProfilePopupToggle:u,onSubmitProfile:p}),o.a.createElement(C,{isAddPlacePopupOpen:t,onAddPlacePopupToggle:c,onSubmitPlace:g}),o.a.createElement(j,{isEditAvatarPopupOpen:a,onEditAvatarPopupToggle:i,onSubmitAvatar:m})))})),S=a(12),A=a(13),T=new(function(){function e(t,a){Object(S.a)(this,e),this.url=t,this.token=a}return Object(A.a)(e,[{key:"_getPromiseRes",value:function(e){return e.ok?e.json():Promise.reject(e.status,e.text)}},{key:"getInitialCards",value:function(){return fetch("".concat(this.url,"/cards"),{headers:{authorization:this.token}}).then(this._getPromiseRes).catch((function(e){return console.error(e)}))}},{key:"getUserInfo",value:function(){return fetch("".concat(this.url,"/users/me"),{headers:{authorization:this.token}}).then(this._getPromiseRes).catch((function(e){return console.error(e)}))}},{key:"updateUserInfo",value:function(e,t){return fetch("".concat(this.url,"/users/me"),{method:"PATCH",headers:{authorization:this.token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then(this._getPromiseRes).catch((function(e){console.error(e)}))}},{key:"updateUserAvatar",value:function(e){return fetch("".concat(this.url,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this.token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(this._getPromiseRes).catch((function(e){console.error(e)}))}},{key:"postCard",value:function(e,t){return fetch("".concat(this.url,"/cards"),{method:"POST",headers:{authorization:this.token,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then(this._getPromiseRes).catch((function(e){console.error(e)}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this.url,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this.token}}).then(this._getPromiseRes).catch((function(e){console.error(e)}))}},{key:"updateLike",value:function(e,t){return fetch("".concat(this.url,"/cards/like/").concat(e),{method:t?"DELETE":"PUT",headers:{authorization:this.token}}).then(this._getPromiseRes).catch((function(e){console.error(e)}))}}]),e}())("https://nomoreparties.co/cohort4","87f8a436-5ee7-4266-9bfc-523daea2f9ff");var x=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(!1),s=Object(l.a)(c,2),p=s[0],f=s[1],h=Object(n.useState)(!1),_=Object(l.a)(h,2),v=_[0],g=_[1],E=Object(n.useState)(null),P=Object(l.a)(E,2),O=P[0],k=P[1],N=Object(n.useState)({}),C=Object(l.a)(N,2),j=C[0],S=C[1],A=Object(n.useState)([]),x=Object(l.a)(A,2),I=x[0],L=x[1];Object(n.useEffect)((function(){T.getInitialCards().then((function(e){L(e)})).catch((function(e){return console.error(e)}))}),[]),Object(n.useEffect)((function(){T.getUserInfo().then((function(e){var t=e.avatar,a=e.name,n=e.about,o=e._id;S((function(e){return Object(u.a)(Object(u.a)({},e),{},{name:a,about:n,avatar:t,_id:o})}))})).catch((function(e){return console.error(e)}))}),[]);var R=function(){g(!v)},D=function(){r(!a)},H=function(){f(!p)};return o.a.createElement(b.Provider,{value:j},o.a.createElement(m,null),o.a.createElement(y,{isEditProfileOpen:a,isAddPlacePopupOpen:p,isEditAvatarPopupOpen:v,onEditAvatarPopupToggle:R,onEditProfilePopupToggle:D,onAddPlacePopupToggle:H,selectedImage:O,onCardClick:function(e){k(O?null:e)},submitProfile:function(e){var t=e.name,a=e.about;T.updateUserInfo(t,a).then((function(e){S(e),D()}))},onSubmitAvatar:function(e){var t=e.avatar;T.updateUserAvatar(t).then((function(e){S((function(t){return Object(u.a)(Object(u.a)({},t),{},{avatar:e.avatar})})),R()}))},onSubmitPlace:function(e,t){T.postCard(e,t).then((function(e){return L([].concat(Object(i.a)(I),[e]))})).then((function(){return H()}))},onCardDelete:function(e){T.deleteCard(e).then((function(){L((function(t){return t.filter((function(t){return t._id!==e}))}))}))},onCardLike:function(e,t){T.updateLike(e,t).then((function(t){var a=I.map((function(a){return a._id===e?t:a}));L(a)}))},cards:I}),o.a.createElement(d,null))};c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(x,null)),document.querySelector(".root"))}],[[15,1,2]]]);
//# sourceMappingURL=main.f3c117a0.chunk.js.map